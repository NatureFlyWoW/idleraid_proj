import type { ClassDefinition, AbilityDefinition, TalentTreeDefinition } from '@shared/types';

// ============= DRUID ABILITIES =============

const druidAbilities: AbilityDefinition[] = [
  // Core abilities (no talent required) - Caster Form
  {
    id: 'wrath',
    name: 'Wrath',
    description: 'Causes 88 to 100 Nature damage to the target.',
    type: 'cast',
    resourceCost: 75,
    cooldownSeconds: 0,
    castTimeSeconds: 2,
    baseDamage: 94,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0.571,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 1,
  },
  {
    id: 'moonfire',
    name: 'Moonfire',
    description: 'Burns the enemy for 35 Arcane damage and then an additional 70 Arcane damage over 12 sec.',
    type: 'instant',
    resourceCost: 75,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 35,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0.15,
    isAoE: false,
    isDot: true,
    isHot: false,
    tickCount: 4,
    tickIntervalSeconds: 3,
    levelRequired: 4,
  },
  {
    id: 'rejuvenation',
    name: 'Rejuvenation',
    description: 'Heals the target for 168 over 12 sec.',
    type: 'instant',
    resourceCost: 95,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 168,
    apCoefficient: 0,
    spCoefficient: 0.8,
    isAoE: false,
    isDot: false,
    isHot: true,
    tickCount: 4,
    tickIntervalSeconds: 3,
    levelRequired: 4,
  },
  {
    id: 'thorns',
    name: 'Thorns',
    description: 'Thorns sprout from the friendly target causing 18 Nature damage to attackers. Lasts 10 min.',
    type: 'instant',
    resourceCost: 55,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 18,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 6,
  },
  {
    id: 'entangling_roots',
    name: 'Entangling Roots',
    description: 'Roots the target in place and causes 44 Nature damage over 12 sec. Damage may interrupt effect.',
    type: 'cast',
    resourceCost: 50,
    cooldownSeconds: 0,
    castTimeSeconds: 1.5,
    baseDamage: 44,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0.2,
    isAoE: false,
    isDot: true,
    isHot: false,
    tickCount: 6,
    tickIntervalSeconds: 2,
    levelRequired: 8,
  },
  {
    id: 'regrowth',
    name: 'Regrowth',
    description: 'Heals a friendly target for 244 to 275 and another 147 over 21 sec.',
    type: 'cast',
    resourceCost: 180,
    cooldownSeconds: 0,
    castTimeSeconds: 2,
    baseDamage: 0,
    baseHealing: 260,
    apCoefficient: 0,
    spCoefficient: 0.286,
    isAoE: false,
    isDot: false,
    isHot: true,
    tickCount: 7,
    tickIntervalSeconds: 3,
    levelRequired: 12,
  },
  {
    id: 'healing_touch',
    name: 'Healing Touch',
    description: 'Heals a friendly target for 456 to 543.',
    type: 'cast',
    resourceCost: 155,
    cooldownSeconds: 0,
    castTimeSeconds: 3.5,
    baseDamage: 0,
    baseHealing: 500,
    apCoefficient: 0,
    spCoefficient: 1.0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 1,
  },
  {
    id: 'starfire',
    name: 'Starfire',
    description: 'Causes 118 to 138 Arcane damage to the target.',
    type: 'cast',
    resourceCost: 95,
    cooldownSeconds: 0,
    castTimeSeconds: 3.5,
    baseDamage: 128,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 1.0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 20,
  },
  // Bear Form abilities
  {
    id: 'bear_form',
    name: 'Bear Form',
    description: 'Shapeshift into a bear, increasing armor and stamina. Generates rage when hit or attacking.',
    type: 'instant',
    resourceCost: 0,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 10,
  },
  {
    id: 'maul',
    name: 'Maul',
    description: 'A strong attack that increases melee damage by 78. Requires Bear Form.',
    type: 'instant',
    resourceCost: 15,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 78,
    baseHealing: 0,
    apCoefficient: 0.15,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    requiresWeapon: 'melee',
    levelRequired: 10,
  },
  {
    id: 'demoralizing_roar',
    name: 'Demoralizing Roar',
    description: 'The druid roars, decreasing the attack power of enemies within 10 yards by 68. Requires Bear Form.',
    type: 'instant',
    resourceCost: 10,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: true,
    maxTargets: 8,
    isDot: false,
    isHot: false,
    levelRequired: 14,
  },
  {
    id: 'swipe',
    name: 'Swipe',
    description: 'Swipe nearby enemies, inflicting 45 damage to up to 3 targets. Requires Bear Form.',
    type: 'instant',
    resourceCost: 20,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 45,
    baseHealing: 0,
    apCoefficient: 0.1,
    spCoefficient: 0,
    isAoE: true,
    maxTargets: 3,
    isDot: false,
    isHot: false,
    levelRequired: 16,
  },
  {
    id: 'growl',
    name: 'Growl',
    description: 'Taunts the target to attack you. Requires Bear Form.',
    type: 'instant',
    resourceCost: 0,
    cooldownSeconds: 10,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 10,
  },
  // Cat Form abilities
  {
    id: 'cat_form',
    name: 'Cat Form',
    description: 'Shapeshift into a cat, increasing attack speed and enabling stealth. Uses energy.',
    type: 'instant',
    resourceCost: 0,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 20,
  },
  {
    id: 'claw',
    name: 'Claw',
    description: 'Claw the enemy, causing 43 damage. Awards 1 combo point. Requires Cat Form.',
    type: 'instant',
    resourceCost: 40,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 43,
    baseHealing: 0,
    apCoefficient: 0.1,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 20,
  },
  {
    id: 'rake',
    name: 'Rake',
    description: 'Rake the target for 28 bleed damage and an additional 63 over 9 sec. Awards 1 combo point. Requires Cat Form.',
    type: 'instant',
    resourceCost: 35,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 28,
    baseHealing: 0,
    apCoefficient: 0.06,
    spCoefficient: 0,
    isAoE: false,
    isDot: true,
    isHot: false,
    tickCount: 3,
    tickIntervalSeconds: 3,
    levelRequired: 24,
  },
  {
    id: 'ferocious_bite',
    name: 'Ferocious Bite',
    description: 'Finishing move that causes damage per combo point. Consumes up to 30 additional energy for more damage. Requires Cat Form.',
    type: 'instant',
    resourceCost: 35,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 50,
    baseHealing: 0,
    apCoefficient: 0.15,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 32,
  },
  {
    id: 'rip',
    name: 'Rip',
    description: 'Finishing move that causes damage over time. Damage increases per combo point. Requires Cat Form.',
    type: 'instant',
    resourceCost: 30,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: true,
    isHot: false,
    tickCount: 6,
    tickIntervalSeconds: 2,
    levelRequired: 20,
  },
  {
    id: 'shred',
    name: 'Shred',
    description: 'Shred the target, causing 90 damage plus 180% weapon damage. Must be behind the target. Awards 1 combo point. Requires Cat Form.',
    type: 'instant',
    resourceCost: 60,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 90,
    baseHealing: 0,
    apCoefficient: 0.4,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    levelRequired: 22,
  },
  // Talent abilities
  {
    id: 'moonkin_form',
    name: 'Moonkin Form',
    description: 'Shapeshift into Moonkin Form. While in this form, armor contribution from items is increased by 360% and spell critical strike chance increased by 3%.',
    type: 'instant',
    resourceCost: 0,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    requiresTalent: 'moonkin_form_talent',
    levelRequired: 40,
  },
  {
    id: 'feral_charge',
    name: 'Feral Charge',
    description: 'Causes you to charge an enemy, immobilizing them for 4 sec. Requires Bear Form.',
    type: 'instant',
    resourceCost: 5,
    cooldownSeconds: 15,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    requiresTalent: 'feral_charge_talent',
    levelRequired: 20,
  },
  {
    id: 'insect_swarm',
    name: 'Insect Swarm',
    description: 'The enemy target is swarmed by insects, decreasing their chance to hit by 2% and causing 216 Nature damage over 12 sec.',
    type: 'instant',
    resourceCost: 85,
    cooldownSeconds: 0,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0.3,
    isAoE: false,
    isDot: true,
    isHot: false,
    tickCount: 6,
    tickIntervalSeconds: 2,
    requiresTalent: 'insect_swarm_talent',
    levelRequired: 20,
  },
  {
    id: 'swiftmend',
    name: 'Swiftmend',
    description: 'Consumes a Rejuvenation or Regrowth effect on a friendly target to instantly heal them.',
    type: 'instant',
    resourceCost: 200,
    cooldownSeconds: 15,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 600,
    apCoefficient: 0,
    spCoefficient: 1.0,
    isAoE: false,
    isDot: false,
    isHot: false,
    requiresTalent: 'swiftmend_talent',
    levelRequired: 40,
  },
  {
    id: 'natures_swiftness',
    name: "Nature's Swiftness",
    description: 'When activated, your next Nature spell with a casting time less than 10 sec becomes an instant cast spell.',
    type: 'instant',
    resourceCost: 0,
    cooldownSeconds: 180,
    castTimeSeconds: 0,
    baseDamage: 0,
    baseHealing: 0,
    apCoefficient: 0,
    spCoefficient: 0,
    isAoE: false,
    isDot: false,
    isHot: false,
    requiresTalent: 'natures_swiftness_talent',
    levelRequired: 30,
  },
];

// ============= DRUID TALENT TREES =============

const balanceTalentTree: TalentTreeDefinition = {
  id: 'balance',
  name: 'Balance',
  description: 'Uses the power of Nature and Arcane to destroy enemies from afar.',
  role: 'dps',
  talents: [
    // Tier 1 (0 points required)
    {
      id: 'improved_wrath',
      name: 'Improved Wrath',
      description: 'Reduces the cast time of your Wrath spell by 0.1/0.2/0.3/0.4/0.5 sec.',
      tier: 1,
      column: 1,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'wrath', stat: 'castTime', valuePerRank: -0.1 }],
    },
    {
      id: 'natures_grasp',
      name: "Nature's Grasp",
      description: 'While active, any time an enemy strikes the caster they have a 35% chance to become afflicted by Entangling Roots.',
      tier: 1,
      column: 2,
      maxRanks: 1,
      requiredPoints: 0,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'natures_grasp', valuePerRank: 1 }],
    },
    {
      id: 'improved_moonfire',
      name: 'Improved Moonfire',
      description: 'Increases the damage and critical strike chance of your Moonfire spell by 2/4/6/8/10%.',
      tier: 1,
      column: 3,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'moonfire', stat: 'damage', valuePerRank: 2, isPercentage: true }],
    },
    // Tier 2 (5 points required)
    {
      id: 'natural_weapons',
      name: 'Natural Weapons',
      description: 'Increases the damage you deal with physical attacks in all forms by 2/4/6/8/10%.',
      tier: 2,
      column: 1,
      maxRanks: 5,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'physicalDamage', valuePerRank: 2, isPercentage: true }],
    },
    {
      id: 'natural_shapeshifter',
      name: 'Natural Shapeshifter',
      description: 'Reduces the mana cost of all shapeshifting by 10/20/30%.',
      tier: 2,
      column: 2,
      maxRanks: 3,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'shapeshiftManaCost', valuePerRank: -10, isPercentage: true }],
    },
    {
      id: 'improved_thorns',
      name: 'Improved Thorns',
      description: 'Increases damage caused by your Thorns spell by 25/50/75%.',
      tier: 2,
      column: 3,
      maxRanks: 3,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'thorns', stat: 'damage', valuePerRank: 25, isPercentage: true }],
    },
    // Tier 3 (10 points required)
    {
      id: 'omen_of_clarity',
      name: 'Omen of Clarity',
      description: 'Each of your attacks has a chance to trigger Clearcasting, making your next spell cost no mana.',
      tier: 3,
      column: 1,
      maxRanks: 1,
      requiredPoints: 10,
      type: 'proc',
      effects: [{ type: 'proc', procChance: 6, procTrigger: 'melee_hit', procEffect: 'clearcasting', valuePerRank: 1 }],
    },
    {
      id: 'natures_reach',
      name: "Nature's Reach",
      description: 'Increases the range of your Balance spells and Faerie Fire by 10/20%.',
      tier: 3,
      column: 2,
      maxRanks: 2,
      requiredPoints: 10,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'spellRange', valuePerRank: 10, isPercentage: true }],
    },
    {
      id: 'vengeance',
      name: 'Vengeance',
      description: 'Increases the critical strike damage bonus of your Starfire, Moonfire, and Wrath spells by 20/40/60/80/100%.',
      tier: 3,
      column: 3,
      maxRanks: 5,
      requiredPoints: 10,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'spellCritDamage', valuePerRank: 20, isPercentage: true }],
    },
    // Tier 4 (15 points required)
    {
      id: 'improved_starfire',
      name: 'Improved Starfire',
      description: 'Reduces the cast time of your Starfire spell by 0.1/0.2/0.3/0.4/0.5 sec.',
      tier: 4,
      column: 2,
      maxRanks: 5,
      requiredPoints: 15,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'starfire', stat: 'castTime', valuePerRank: -0.1 }],
    },
    // Tier 5 (20 points required)
    {
      id: 'natures_grace',
      name: "Nature's Grace",
      description: "All spell critical strikes have a 100% chance to reduce the casting time of your next spell by 0.5 sec.",
      tier: 5,
      column: 2,
      maxRanks: 1,
      requiredPoints: 20,
      type: 'proc',
      effects: [{ type: 'proc', procChance: 100, procTrigger: 'spell_crit', procEffect: 'cast_time_reduction', valuePerRank: 0.5 }],
    },
    {
      id: 'moonglow',
      name: 'Moonglow',
      description: 'Reduces the mana cost of your Moonfire, Starfire, Wrath, Healing Touch, Regrowth, and Rejuvenation spells by 3/6/9%.',
      tier: 5,
      column: 3,
      maxRanks: 3,
      requiredPoints: 20,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'natureManaReduction', valuePerRank: 3, isPercentage: true }],
    },
    // Tier 6 (25 points required)
    {
      id: 'moonfury',
      name: 'Moonfury',
      description: 'Increases the damage done by your Starfire, Moonfire, and Wrath spells by 2/4/6/8/10%.',
      tier: 6,
      column: 2,
      maxRanks: 5,
      requiredPoints: 25,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'balanceSpellDamage', valuePerRank: 2, isPercentage: true }],
    },
    // Tier 7 (30 points required) - Capstone
    {
      id: 'moonkin_form_talent',
      name: 'Moonkin Form',
      description: 'Shapeshift into Moonkin Form. While in this form, armor contribution from items is increased by 360% and spell critical strike chance increased by 3%.',
      tier: 7,
      column: 2,
      maxRanks: 1,
      requiredPoints: 30,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'moonkin_form', valuePerRank: 1 }],
    },
  ],
};

const feralTalentTree: TalentTreeDefinition = {
  id: 'feral',
  name: 'Feral Combat',
  description: 'Focuses on physical combat in Bear and Cat forms.',
  role: 'hybrid',
  talents: [
    // Tier 1 (0 points required)
    {
      id: 'ferocity',
      name: 'Ferocity',
      description: 'Reduces the cost of your Maul, Swipe, Claw, and Rake abilities by 1/2/3/4/5.',
      tier: 1,
      column: 1,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'feral_abilities', stat: 'resourceCost', valuePerRank: -1 }],
    },
    {
      id: 'feral_aggression',
      name: 'Feral Aggression',
      description: 'Increases the attack power reduction of your Demoralizing Roar by 8/16/24/32/40%.',
      tier: 1,
      column: 2,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'demoralizing_roar', stat: 'effectiveness', valuePerRank: 8, isPercentage: true }],
    },
    {
      id: 'sharpened_claws',
      name: 'Sharpened Claws',
      description: 'Increases your critical strike chance while in Cat, Bear, or Moonkin Form by 2/4/6%.',
      tier: 1,
      column: 3,
      maxRanks: 3,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'meleeCritChance', valuePerRank: 2, isPercentage: true }],
    },
    // Tier 2 (5 points required)
    {
      id: 'thick_hide',
      name: 'Thick Hide',
      description: 'Increases your armor contribution from items by 4/7/10%.',
      tier: 2,
      column: 1,
      maxRanks: 3,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'armorFromItems', valuePerRank: 4, isPercentage: true }],
    },
    {
      id: 'feral_instinct',
      name: 'Feral Instinct',
      description: 'Increases threat caused in Bear Form by 3/6/9/12/15%.',
      tier: 2,
      column: 2,
      maxRanks: 5,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'bearThreat', valuePerRank: 3, isPercentage: true }],
    },
    {
      id: 'feral_swiftness',
      name: 'Feral Swiftness',
      description: 'Increases your movement speed by 15/30% while in Cat Form and increases your chance to dodge by 2/4%.',
      tier: 2,
      column: 3,
      maxRanks: 2,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'dodgeChance', valuePerRank: 2, isPercentage: true }],
    },
    // Tier 3 (10 points required)
    {
      id: 'feral_charge_talent',
      name: 'Feral Charge',
      description: 'Causes you to charge an enemy, immobilizing them for 4 sec. Requires Bear Form.',
      tier: 3,
      column: 1,
      maxRanks: 1,
      requiredPoints: 10,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'feral_charge', valuePerRank: 1 }],
    },
    {
      id: 'predatory_strikes',
      name: 'Predatory Strikes',
      description: 'Increases your attack power in Cat, Bear, and Moonkin Forms by 50/100/150% of your level.',
      tier: 3,
      column: 2,
      maxRanks: 3,
      requiredPoints: 10,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'attackPowerPerLevel', valuePerRank: 0.5 }],
    },
    {
      id: 'blood_frenzy',
      name: 'Blood Frenzy',
      description: 'Your critical strikes from Cat Form abilities that add combo points have a 50/100% chance to add an additional combo point.',
      tier: 3,
      column: 3,
      maxRanks: 2,
      requiredPoints: 10,
      type: 'proc',
      effects: [{ type: 'proc', procChance: 50, procTrigger: 'combo_crit', procEffect: 'bonus_combo', valuePerRank: 1 }],
    },
    // Tier 4 (15 points required)
    {
      id: 'primal_fury',
      name: 'Primal Fury',
      description: 'Gives you a 50/100% chance to gain an additional 5 Rage when you deal a critical strike while in Bear Form.',
      tier: 4,
      column: 1,
      maxRanks: 2,
      requiredPoints: 15,
      type: 'proc',
      effects: [{ type: 'proc', procChance: 50, procTrigger: 'bear_crit', procEffect: 'rage_gain', valuePerRank: 5 }],
    },
    {
      id: 'savage_fury',
      name: 'Savage Fury',
      description: 'Increases the damage caused by your Claw, Rake, Maul, and Swipe abilities by 10/20%.',
      tier: 4,
      column: 2,
      maxRanks: 2,
      requiredPoints: 15,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'feral_melee', stat: 'damage', valuePerRank: 10, isPercentage: true }],
    },
    {
      id: 'heart_of_the_wild',
      name: 'Heart of the Wild',
      description: 'Increases your Intellect by 4/8/12/16/20%. In addition, while in Bear Form your Stamina is increased by 4/8/12/16/20% and while in Cat Form your attack power is increased by 4/8/12/16/20%.',
      tier: 4,
      column: 3,
      maxRanks: 5,
      requiredPoints: 15,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'intellect', valuePerRank: 4, isPercentage: true }],
    },
    // Tier 7 (30 points required) - Capstone
    {
      id: 'leader_of_the_pack',
      name: 'Leader of the Pack',
      description: 'While in Cat, Bear, or Moonkin Form, the Leader of the Pack increases ranged and melee critical chance of all party members within 45 yards by 3%.',
      tier: 7,
      column: 2,
      maxRanks: 1,
      requiredPoints: 30,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'partyCritAura', valuePerRank: 3, isPercentage: true }],
    },
  ],
};

const restorationTalentTree: TalentTreeDefinition = {
  id: 'restoration',
  name: 'Restoration',
  description: 'Allows the druid to focus on healing and regeneration.',
  role: 'healer',
  talents: [
    // Tier 1 (0 points required)
    {
      id: 'improved_mark_of_the_wild',
      name: 'Improved Mark of the Wild',
      description: 'Increases the effects of your Mark of the Wild and Gift of the Wild spells by 7/14/21/28/35%.',
      tier: 1,
      column: 1,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'mark_of_the_wild', stat: 'effectiveness', valuePerRank: 7, isPercentage: true }],
    },
    {
      id: 'furor',
      name: 'Furor',
      description: 'Gives you a 20/40/60/80/100% chance to gain 10 Rage when you shapeshift into Bear Form and 40 Energy when you shapeshift into Cat Form.',
      tier: 1,
      column: 2,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'proc',
      effects: [{ type: 'proc', procChance: 20, procTrigger: 'shapeshift', procEffect: 'resource_gain', valuePerRank: 10 }],
    },
    {
      id: 'naturalist',
      name: 'Naturalist',
      description: 'Reduces the cast time of your Healing Touch spell by 0.1/0.2/0.3/0.4/0.5 sec and increases the damage you deal with physical attacks by 2/4/6/8/10%.',
      tier: 1,
      column: 3,
      maxRanks: 5,
      requiredPoints: 0,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'healing_touch', stat: 'castTime', valuePerRank: -0.1 }],
    },
    // Tier 2 (5 points required)
    {
      id: 'natures_focus',
      name: "Nature's Focus",
      description: 'Gives you a 14/28/42/56/70% chance to avoid interruption caused by damage while casting Healing Touch and Regrowth.',
      tier: 2,
      column: 1,
      maxRanks: 5,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'healingPushbackResist', valuePerRank: 14, isPercentage: true }],
    },
    {
      id: 'improved_rejuvenation',
      name: 'Improved Rejuvenation',
      description: 'Increases the effect of your Rejuvenation spell by 5/10/15%.',
      tier: 2,
      column: 2,
      maxRanks: 3,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'rejuvenation', stat: 'healing', valuePerRank: 5, isPercentage: true }],
    },
    {
      id: 'subtlety',
      name: 'Subtlety',
      description: 'Reduces the threat generated by your healing spells by 4/8/12/16/20%.',
      tier: 2,
      column: 3,
      maxRanks: 5,
      requiredPoints: 5,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'healingThreat', valuePerRank: -4, isPercentage: true }],
    },
    // Tier 3 (10 points required)
    {
      id: 'reflection',
      name: 'Reflection',
      description: 'Allows 5/10/15% of your mana regeneration to continue while casting.',
      tier: 3,
      column: 1,
      maxRanks: 3,
      requiredPoints: 10,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'manaRegenWhileCasting', valuePerRank: 5, isPercentage: true }],
    },
    {
      id: 'insect_swarm_talent',
      name: 'Insect Swarm',
      description: 'The enemy target is swarmed by insects, decreasing their chance to hit by 2% and causing Nature damage over 12 sec.',
      tier: 3,
      column: 2,
      maxRanks: 1,
      requiredPoints: 10,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'insect_swarm', valuePerRank: 1 }],
    },
    {
      id: 'gift_of_nature',
      name: 'Gift of Nature',
      description: 'Increases the effect of all healing spells by 2/4/6/8/10%.',
      tier: 3,
      column: 3,
      maxRanks: 5,
      requiredPoints: 10,
      type: 'passive',
      effects: [{ type: 'stat_bonus', stat: 'healingBonus', valuePerRank: 2, isPercentage: true }],
    },
    // Tier 4 (15 points required)
    {
      id: 'tranquil_spirit',
      name: 'Tranquil Spirit',
      description: 'Reduces the mana cost of your Healing Touch and Tranquility spells by 2/4/6/8/10%.',
      tier: 4,
      column: 1,
      maxRanks: 5,
      requiredPoints: 15,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'healing_touch', stat: 'resourceCost', valuePerRank: -2, isPercentage: true }],
    },
    {
      id: 'improved_regrowth',
      name: 'Improved Regrowth',
      description: 'Increases the critical effect chance of your Regrowth spell by 10/20/30/40/50%.',
      tier: 4,
      column: 2,
      maxRanks: 5,
      requiredPoints: 15,
      type: 'passive',
      effects: [{ type: 'ability_modifier', abilityId: 'regrowth', stat: 'critChance', valuePerRank: 10 }],
    },
    {
      id: 'natures_swiftness_talent',
      name: "Nature's Swiftness",
      description: 'When activated, your next Nature spell with a casting time less than 10 sec becomes an instant cast spell.',
      tier: 4,
      column: 3,
      maxRanks: 1,
      requiredPoints: 15,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'natures_swiftness', valuePerRank: 1 }],
    },
    // Tier 7 (30 points required) - Capstone
    {
      id: 'swiftmend_talent',
      name: 'Swiftmend',
      description: 'Consumes a Rejuvenation or Regrowth effect on a friendly target to instantly heal them.',
      tier: 7,
      column: 2,
      maxRanks: 1,
      requiredPoints: 30,
      type: 'active',
      effects: [{ type: 'ability_unlock', abilityId: 'swiftmend', valuePerRank: 1 }],
    },
  ],
};

// ============= DRUID CLASS DEFINITION =============

export const druidClass: ClassDefinition = {
  id: 'druid',
  name: 'Druid',
  description: 'Druids harness the vast powers of nature to preserve balance and protect life. They can shapeshift into a variety of forms, taking on the roles of tank, healer, or damage dealer.',
  resourceType: 'mana',
  armorType: 'leather',

  baseStats: {
    health: 80,    // GDD: 80
    resource: 160, // GDD: Mana 160
    strength: 14,  // GDD: 14
    agility: 14,   // GDD: 14
    intellect: 16, // GDD: 16
    stamina: 14,   // GDD: 14
    spirit: 15,    // Not specified in GDD, balanced estimate
  },

  statScaling: {
    strengthToAP: 2.0,
    agilityToAP: 1.0,
    agilityToCrit: 0.05,
    agilityToRangedAP: 0,
    intellectToMana: 15,
    intellectToSpellPower: 0.8,
    intellectToSpellCrit: 0.01,
    staminaToHealth: 10,
    spiritToRegen: 0.4,
  },

  talentTrees: [balanceTalentTree, feralTalentTree, restorationTalentTree],
  abilities: druidAbilities,
};

export default druidClass;
